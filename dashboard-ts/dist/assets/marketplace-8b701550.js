import{p as v,j as e,S as x,L as M,T as y,B as S,m as I,r as u,v as E,W as F}from"./index-c1be743a.js";import{B as f,C as g,N as j,a as B,f as R,p as U}from"./NFTMarketplace-a3d69bb5.js";import{c as w,N as A}from"./no-nfts-31e9c2f5.js";import{C as D}from"./Card-3aa4196d.js";import{C as L}from"./CardMedia-5fdf9f74.js";import{C as P}from"./CardContent-1f5ce5ed.js";import{C as G}from"./Chip-16ebfb26.js";import{M as C}from"./index-fbe56cf4.js";import{C as H}from"./Container-c4415724.js";import{G as k}from"./Grid-5556d8af.js";function V({price:n,name:i,image:p,buyNft:o}){const c=v();return e.jsxs(D,{sx:{width:300,height:"100%",cursor:"pointer",boxShadow:3},children:[e.jsx(L,{image:p,title:"This is your NFT "+i,sx:{height:150,objectFit:"cover"}}),e.jsxs(P,{children:[e.jsxs(x,{direction:"row",spacing:2,sx:{justifyContent:"space-between"},children:[e.jsx(M,{color:"inherit",underline:"hover",variant:"h6",noWrap:!0,sx:{flexGrow:1,cursor:"pointer"},children:i}),e.jsxs(x,{direction:"row",alignItems:"center",spacing:1,sx:{justifyContent:"flex-end"},children:[e.jsx(y,{variant:"subtitle1",children:n}),e.jsx(G,{icon:e.jsx("img",{src:"/assets/ethereum.svg",alt:"ETH",width:18,height:18}),label:"ETH",size:"small",sx:{marginRight:1,backgroundColor:c.palette.grey[300],display:"flex",alignItems:"center",justifyContent:"center"}})]})]}),e.jsx(S,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:e.jsx(I,{variant:"contained",onClick:o,sx:{width:"35%"},children:"Buy"})})]})]})}const W=()=>{const[n,i]=u.useState([]),[p,o]=u.useState("not-loaded");E(),u.useEffect(()=>{c()},[]);async function c(){try{const t=new f(window.ethereum),s=new g(C,j.abi,t),l=await s.fetchMarketItems(),d=[];for(let a=0;a<l.length;a++){const r=l[a],N=await s.tokenURI(r.tokenId),m=(await B.get(w(N.replace("/metadata.json",""))+"/metadata.json")).data;console.log("META",m);let b={price:R(r.price.toString(),"ether"),tokenId:r.tokenId,seller:r.seller,owner:r.owner,image:w(m.image,!0),name:m.name,description:m.description};d.push(b)}const h=d.filter(a=>a!==null);i(h),o("loaded")}catch(t){console.error("Error loading NFTs:",t),o("error")}}async function T(t){const l=await new f(window.ethereum).getSigner(),d=new g(C,j.abi,l),h=U(t.price.toString(),"ether"),r=await(await d.createMarketSale(t.tokenId,{value:h})).wait();console.log("bought data: ",r),c()}return p==="loaded"&&!n.length?e.jsx(A,{title:"NFT Marketplace",body:"No items in the marketplace"}):e.jsxs(H,{children:[e.jsx(x,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(y,{variant:"h4",children:"NFT Marketplace"})}),e.jsx(k,{container:!0,children:n.map((t,s)=>e.jsx(k,{item:!0,xs:!0,sm:!0,md:!0,sx:{my:.4},children:e.jsx(V,{price:t.price,name:t.name,image:t.image,buyNft:()=>T(t)})},s))})]})},_=W;function re(){return e.jsxs(e.Fragment,{children:[e.jsx(F,{children:e.jsx("title",{children:" Marketplace | Minimal UI "})}),e.jsx(_,{})]})}export{re as default};
